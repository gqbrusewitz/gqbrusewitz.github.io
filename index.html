<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workout Log</title>

  <!-- PWA manifest -->
  <link rel="manifest" href="pwa/manifest.json">

  <!-- Basic styles -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>Workout Log</h1>
    <button id="theme-toggle" class="btn-secondary" title="Toggle theme">Toggle Theme</button>
  </header>

  <nav class="tabs">
    <button class="tab-button active" data-tab="log">Log Workout</button>
    <button class="tab-button" data-tab="history">History</button>
    <button class="tab-button" data-tab="analytics">Analytics</button>
    <button class="tab-button" data-tab="settings">Settings</button>
  </nav>

  <main>
    <!-- Log Workout -->
    <section id="tab-log" class="tab active">
      <div class="card">
        <h2>Today&apos;s Workout</h2>

        <div class="field-row">
          <label for="workout-date">Date</label>
          <input type="date" id="workout-date">
        </div>

        <div class="field-row">
          <label for="workout-notes">Notes</label>
          <textarea id="workout-notes" rows="2" placeholder="Optional notes about this workout"></textarea>
        </div>

        <h3>Exercises</h3>
        <div class="field-row">
          <label for="template-select">Import saved workout template</label>
          <div class="template-import-row">
            <select id="template-select">
              <option value="">No saved workouts yet</option>
            </select>
            <button id="import-template" class="btn-secondary" type="button">Use Saved</button>
            <button id="import-template-file-btn" class="btn-secondary" type="button">Upload JSON</button>
            <input type="file" id="template-file-input" accept=".json" hidden>
          </div>
          <small>Use a previously saved workout or upload a JSON template (like the sample download) as a starting point.</small>
        </div>
        <div id="exercise-list"></div>

        <button id="add-exercise" class="btn-primary">+ Add Exercise</button>

        <div class="summary-row">
          <div>Total Sets: <span id="summary-sets">0</span></div>
          <div>Total Reps: <span id="summary-reps">0</span></div>
          <div>Total Volume: <span id="summary-volume">0</span></div>
        </div>

        <div class="button-row">
          <button id="start-workout" class="btn-secondary">Start Workout</button>
          <button id="end-workout" class="btn-secondary" disabled>End Workout</button>
          <span id="workout-duration" class="pill">Duration: 0:00</span>
        </div>

        <div class="button-row">
          <button id="save-workout" class="btn-primary">Save Workout</button>
        </div>
      </div>

      <div class="card">
        <h2>Rest Timer</h2>
        <div class="field-row">
          <label for="rest-seconds">Rest (seconds)</label>
          <input type="number" id="rest-seconds" min="5" value="60">
        </div>
        <div class="button-row">
          <button id="start-rest" class="btn-primary">Start Rest</button>
          <span id="rest-display" class="pill">Ready</span>
        </div>
      </div>
    </section>

    <!-- History -->
    <section id="tab-history" class="tab">
      <div class="card">
        <h2>Workout History</h2>

        <div class="field-row">
          <label for="history-search">Search exercises</label>
          <input type="text" id="history-search" placeholder="Type to filter by exercise name">
        </div>

        <div class="field-row">
          <label for="history-sort">Sort by</label>
          <select id="history-sort">
            <option value="date-desc">Date (newest)</option>
            <option value="date-asc">Date (oldest)</option>
            <option value="volume-desc">Volume (high → low)</option>
            <option value="volume-asc">Volume (low → high)</option>
          </select>
        </div>

        <div id="history-list"></div>
      </div>

      <div class="card">
        <h2>Export / Import</h2>
        <div class="button-row">
          <button id="export-csv" class="btn-secondary">Export CSV</button>
          <input type="file" id="import-csv" accept=".csv" />
        </div>
        <small>Export downloads a CSV of all workouts. Import will merge compatible CSV data into your log.</small>
      </div>
    </section>

    <!-- Analytics -->
    <section id="tab-analytics" class="tab">
      <div class="card">
        <h2>Analytics</h2>
        <p>These charts are based on your saved workouts.</p>

        <h3>Weekly Volume</h3>
        <canvas id="volume-chart"></canvas>

        <h3>Workout Frequency</h3>
        <canvas id="frequency-chart"></canvas>

        <h3>Top Personal Records (Heaviest Set)</h3>
        <ul id="pr-list"></ul>
      </div>
    </section>

    <!-- Settings -->
    <section id="tab-settings" class="tab">
      <div class="card">
        <h2>Settings</h2>

        <div class="field-row">
          <label for="units-select">Units</label>
          <select id="units-select">
            <option value="lbs">Pounds (lb)</option>
            <option value="kg">Kilograms (kg)</option>
          </select>
        </div>

        <div class="field-row">
          <label for="default-rest">Default Rest (seconds)</label>
          <input type="number" id="default-rest" min="5" value="60">
        </div>

        <div class="button-row">
          <button id="save-settings" class="btn-primary">Save Settings</button>
        </div>
      </div>

      <div class="card">
        <h2>Backup / Restore</h2>
        <div class="button-row">
          <button id="export-json" class="btn-secondary">Download Backup JSON</button>
          <input type="file" id="import-json" accept=".json" />
        </div>
      </div>

      <div class="card">
        <h2>Workout Templates</h2>
        <p>Download a ready-made workout template that you can import or adapt for your own routines.</p>
        <div class="button-row">
          <button id="download-sample-template" class="btn-secondary" type="button">Download Sample Workout Template</button>
        </div>
      </div>
    </section>
  </main>

  <!-- Scripts (ES modules) -->
  <script type="module" src="js/app.js"></script>

  <!-- Register service worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./pwa/service-worker.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
